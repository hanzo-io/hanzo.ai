{"version":3,"file":"lib.mjs","sources":["../src/index.coffee"],"sourcesContent":["import path from 'path'\n\nexport default (opts = {}) ->\n  opts.plugins   ?= []\n  opts.sourceMap ?= true\n\n  try\n    stylus = require 'stylus'\n  catch err\n    console.error 'Stylus unavailable, `npm install stylus` to transform Stylus files'\n    return name: 'stylup-disabled'\n\n  name: 'stylup'\n  transform: (code, id) ->\n    return if (path.extname id) != '.styl'\n\n    relativePath = path.relative process.cwd(), id\n\n    style = stylus code\n    style.set 'filename', relativePath\n\n    if opts.sourceMap\n      style.set 'sourcemap', comment: false\n\n    for plugin in opts.plugins\n      try\n        style.use plugin\n      catch err\n        console.error 'Failed to use plugin', plugin.toString()\n        throw err\n\n    new Promise (resolve, reject) ->\n      style.render (err, css) ->\n        return reject err if err?\n\n        resolve\n          id:   \"#{id}.css\"\n          code: \"export default #{JSON.stringify(css)};\"\n          map:  style.sourcemap\n"],"names":[],"mappings":";;;AAAA,AAEA,YAAe,SAAC,OAAO,EAAR;MACb;;IAAA,IAAI,CAAC,UAAa;;;IAClB,IAAI,CAAC,YAAa;;;IAGhB,MAAA,GAAS,OAAA,CAAQ,QAAR,EADX;GAAA,aAAA;IAEM;IACJ,OAAO,CAAC,KAAR,CAAc,oEAAd;WACO;MAAA,IAAA,EAAM,iBAAN;MAJT;;SAMA;IAAA,IAAA,EAAM,QAAN;IACA,SAAA,EAAW,SAAC,IAAD,EAAO,EAAP;UACT;MAAA,IAAU,CAAC,IAAI,CAAC,OAAL,CAAa,EAAb,CAAD,MAAqB,OAA/B;eAAA;;MAEA,YAAA,GAAe,IAAI,CAAC,QAAL,CAAc,OAAO,CAAC,GAAR,EAAd,EAA6B,EAA7B;MAEf,KAAA,GAAQ,MAAA,CAAO,IAAP;MACR,KAAK,CAAC,GAAN,CAAU,UAAV,EAAsB,YAAtB;MAEA,IAAG,IAAI,CAAC,SAAR;QACE,KAAK,CAAC,GAAN,CAAU,WAAV,EAAuB;UAAA,OAAA,EAAS,KAAT;SAAvB,EADF;;;WAGA,qCAAA;;;UAEI,KAAK,CAAC,GAAN,CAAU,MAAV,EADF;SAAA,aAAA;UAEM;UACJ,OAAO,CAAC,KAAR,CAAc,sBAAd,EAAsC,MAAM,CAAC,QAAP,EAAtC;gBACM,IAJR;;;aAMF,IAAI,OAAJ,CAAY,SAAC,OAAD,EAAU,MAAV;eACV,KAAK,CAAC,MAAN,CAAa,SAAC,GAAD,EAAM,GAAN;UACX,IAAqB,WAArB;mBAAO,MAAA,CAAO,GAAP,EAAP;;iBAEA,OAAA,CACE;YAAA,EAAA,EAAM,CAAA,EAAG,EAAH,CAAA,IAAA,CAAN;YACA,IAAA,EAAM,CAAA,eAAA,EAAkB,IAAI,CAAC,SAAL,CAAe,GAAf,CAAlB,EAAA,CADN;YAEA,GAAA,EAAM,KAAK,CAAC,SAFZ;WADF;SAHF;OADF;KAnBF;;;;"}